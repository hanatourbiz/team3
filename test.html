<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì „ë‹´ ì„œë¹„ìŠ¤ ì•ˆë‚´ë¬¸ V1.3 (DB ì—°ë™í˜•) | í•˜ë‚˜íˆ¬ì–´ë¹„ì¦ˆë‹ˆìŠ¤</title>
    <style>
        /* [ì›ë³¸ ë³´ì¡´] V1.3 ê³ ìœ  ë””ìì¸ ìŠ¤íƒ€ì¼ */
        :root { --dark-blue: #1a2a4e; --point-red: #e31a1a; --beige: #bca896; }
        body { font-family: 'Pretendard', sans-serif; background: #f0f2f5; margin: 0; padding: 20px; }
        
        /* ê´€ë¦¬ íŒ¨ë„ - ì¸ì‡„ ì‹œ ì œì™¸ */
        .admin-panel { max-width: 1100px; margin: 0 auto 30px; background: #fff; padding: 25px; border-radius: 12px; border: 2px solid var(--dark-blue); }
        .admin-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 2px solid #eee; padding-bottom: 15px; }
        .reg-btn { background: #34a853; color: white; padding: 10px 20px; border: none; border-radius: 6px; font-weight: bold; cursor: pointer; text-decoration: none; font-size: 0.9em; }
        .select-section { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 20px; }
        .select-box { background: #f8f9fa; padding: 10px; border-radius: 8px; border: 1px solid #ddd; }
        .select-box label { display: block; font-size: 0.75em; font-weight: bold; margin-bottom: 5px; }
        select { width: 100%; padding: 5px; border: 1px solid #ccc; border-radius: 4px; }

        /* V1.3 ì•ˆë‚´ë¬¸ ë””ìì¸ (ìˆ˜ì • ê¸ˆì§€) */
        .page { width: 210mm; height: 297mm; padding: 0; margin: 0 auto; background: white; position: relative; color: #333; box-shadow: 0 0 20px rgba(0,0,0,0.1); display: flex; flex-direction: column; overflow: hidden; box-sizing: border-box; }
        .date-bar { background: #3d3229; color: white; padding: 10px 50px; font-size: 1.1em; font-weight: 600; text-align: center; border-bottom: 3px solid var(--beige); flex-shrink: 0; }
        .header { background: var(--dark-blue); color: white; padding: 22px 50px; display: flex; justify-content: space-between; align-items: center; flex-shrink: 0; }
        .header h1 { font-size: 2.2em; margin: 0; line-height: 1.1; font-weight: 800; letter-spacing: -1px; }
        .content-body { padding: 12px 50px; background: #fcfaf8; flex: 1; display: flex; flex-direction: column; justify-content: space-between; min-height: 0; }
        .intro-section { display: flex; gap: 15px; align-items: center; border: 1px solid #e0d6cd; background: #fff; padding: 10px; border-radius: 12px; flex-shrink: 0; }
        .company-logo-main { width: 150px; object-fit: contain; }
        .intro-text-box { flex: 1; font-size: 0.82em; line-height: 1.6; color: #444; border-left: 2px solid #eee; padding-left: 15px; text-align: justify; word-break: keep-all; }
        .team-section { margin-bottom: 5px; flex: 0 1 auto; }
        .team-label { background: var(--beige); color: white; padding: 2px 10px; font-weight: bold; border-radius: 5px 5px 0 0; display: inline-block; font-size: 0.7em; }
        .staff-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 6px; border-top: 2px solid var(--beige); padding-top: 4px; min-height: 60px; }
        .staff-card { background: white; border: 1px solid #e0d6cd; padding: 4px; border-radius: 40px 10px 10px 40px; display: flex; align-items: center; gap: 8px; height: 58px; box-sizing: border-box; }
        .staff-card img { width: 46px; height: 46px; border-radius: 50%; object-fit: cover; border: 1px solid #eee; }
        .staff-info { font-size: 0.55em; line-height: 1.2; overflow: hidden; }
        .staff-info b { font-size: 1.1em; color: var(--dark-blue); }
        .emergency-notice { background: #fff5f5; padding: 8px; text-align: center; border-radius: 8px; font-size: 0.85em; color: #d63031; flex-shrink: 0; margin: 8px 0; border: 1px dashed var(--point-red); font-weight: bold; }
        .promise-container { border: 2px solid #d1d5db; border-radius: 10px; padding: 10px 15px; background: white; display: flex; flex-direction: column; gap: 6px; flex-shrink: 1; }
        .promise-item { display: flex; flex-direction: column; gap: 2px; }
        .promise-title { font-size: 0.95em; font-weight: 900; color: var(--dark-blue); display: flex; align-items: center; gap: 6px; }
        .promise-title::before { content: ""; display: inline-block; width: 4px; height: 12px; background-color: var(--point-red); flex-shrink: 0; }
        .promise-desc { font-size: 0.78em; color: #555; line-height: 1.4; text-align: justify; word-break: keep-all; padding-left: 10px; }
        .footer-index { background: #f8f9fa; border-top: 1px solid #ddd; padding: 12px 50px 18px; display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; flex-shrink: 0; }
        .index-item { border-left: 2px solid var(--beige); padding-left: 12px; }
        .index-item h4 { margin: 0 0 1px; font-size: 0.75em; color: var(--dark-blue); }
        .index-item p { margin: 0; font-size: 0.65em; color: #666; line-height: 1.2; }

        @media print { .admin-panel, #loading { display: none !important; } .page { margin: 0; border: none; box-shadow: none; } }
    </style>
</head>
<body>
    <div id="loading" style="position:fixed; top:0; left:0; width:100%; height:100%; background:white; z-index:9999; display:flex; justify-content:center; align-items:center;">ë°ì´í„° ì—°ë™ ì¤‘...</div>

    <div class="admin-panel">
        <div class="admin-header">
            <h2 style="margin:0;">ğŸ“‹ ì•ˆë‚´ë¬¸ ê´€ë¦¬ì ëª¨ë“œ (V1.9.2)</h2>
            <a href="https://docs.google.com/forms/d/e/1FAIpQLSf6y2inZ1DYqpJXHgFPMGop2PrzBLcJHzzgKwzJMC2F3_cEuA/viewform?usp=publish-editor" target="_blank" class="reg-btn">ğŸ“ ì§ì› ì •ë³´ ë“±ë¡ (Google Form)</a>
        </div>
        
        <div style="display:grid; grid-template-columns: 1fr 1fr 1fr; gap:15px; margin-bottom:20px;">
            <div><label>ë°œì†¡ ë‚ ì§œ</label><input type="text" id="in-date" value="2026ë…„ 2ì›” 20ì¼(ê¸ˆ)" oninput="syncCommon()"></div>
            <div><label>ì—…ì²´ëª…</label><input type="text" id="in-client" value="LH í•œêµ­í† ì§€ì£¼íƒê³µì‚¬" oninput="syncCommon()"></div>
            <div><label>ì—…ì²´ ë¡œê³ </label><input type="file" onchange="loadLogo(event)"></div>
        </div>

        <div class="select-section" id="mgt-selectors"></div>
        <div class="select-section" id="air-selectors"></div>
        <div class="select-section" id="etc-selectors"></div>

        <button onclick="window.print()" style="width:100%; padding:15px; background:var(--point-red); color:white; border:none; border-radius:8px; font-weight:bold; cursor:pointer;">ğŸ–¨ï¸ ì™„ì„±ëœ ì•ˆë‚´ë¬¸ ì¶œë ¥ (PDF ì €ì¥)</button>
    </div>

    <div class="page">
        <div class="date-bar"><b><span id="view-date"></span></b>ë¶€í„° <b><span class="v-client-inline"></span></b> ì¶œì¥ ì „ë‹´ ì—¬í–‰ì‚¬ê°€ ìš´ì˜ë©ë‹ˆë‹¤.</div>
        <div class="header"><h1><span id="view-client"></span><br>ì „ë‹´ ì„œë¹„ìŠ¤íŒ€ êµ¬ì„±</h1><img id="view-logo" src="" style="max-width:150px; display:none; filter:brightness(0) invert(1);"></div>
        <div class="content-body">
            <div class="intro-section">
                <img src="photos/logo2.png" class="company-logo-main" onerror="this.src='https://via.placeholder.com/150x50?text=HanaTour'">
                <div class="intro-text-box">
                    <strong><span class="v-client-inline"></span> ì„ì§ì› ì—¬ëŸ¬ë¶„, ì•ˆë…•í•˜ì‹­ë‹ˆê¹Œ.</strong><br>
                    í•˜ë‚˜íˆ¬ì–´ë¹„ì¦ˆë‹ˆìŠ¤ëŠ” êµ­ë‚´ ìµœëŒ€ ì—¬í–‰ê¸°ì—… í•˜ë‚˜íˆ¬ì–´ê°€ 100% ì¶œìí•œ ë²•ì¸ ì—¬í–‰ ì„œë¹„ìŠ¤ ì „ë¬¸ ì¡°ì§ì…ë‹ˆë‹¤.
                </div>
            </div>
            
            <div class="team-section"><div class="team-label">MANAGEMENT & SUPPORT</div><div class="staff-grid" id="view-mgt"></div></div>
            <div class="team-section"><div class="team-label">AIR SERVICE</div><div class="staff-grid" id="view-air"></div></div>
            <div class="team-section"><div class="team-label">HOTEL, VISA & OTHERS</div><div class="staff-grid" id="view-etc"></div></div>
            
            <div class="emergency-notice">ì—…ë¬´ ì‹œê°„ ì™¸ ğŸš¨ <b>24ì‹œê°„ ê¸´ê¸‰ ì„œë¹„ìŠ¤ ì„¼í„°</b> ( â˜ <b>02-2076-2200</b> )</div>

            <div class="promise-container">
                <div class="promise-item"><div class="promise-title">Global Network & Infrastructure</div><div class="promise-desc">ì „ ì„¸ê³„ ì§€ì‚¬ ë° íŒŒíŠ¸ë„ˆë§ì„ í†µí•´ ì•ˆì •ì ì¸ ì„œë¹„ìŠ¤ë¥¼ ì§€ì›í•©ë‹ˆë‹¤.</div></div>
                <div class="promise-item"><div class="promise-title">Professional Consulting Service</div><div class="promise-desc">ë‹¤ë…„ê°„ì˜ ê³µê³µê¸°ê´€ ì „ë‹´ ì „ë¬¸ê°€ë“¤ì´ ìµœìƒì˜ ì†”ë£¨ì…˜ì„ ì œê³µí•©ë‹ˆë‹¤.</div></div>
            </div>
        </div>
        
        <div class="footer-index">
            <div class="index-item"><h4>SEOUL (HQ) </h4><p>ì„œìš¸ ì¤‘êµ¬ ì¸ì‚¬ë™ 5ê¸¸ 25</p></div>
            <div class="index-item"><h4>DAEGU </h4><p>ëŒ€êµ¬ ì¤‘êµ¬ êµ­ì±„ë³´ìƒë¡œ 648 í˜¸ìˆ˜ë¹Œë”© 15ì¸µ</p></div>
            <div class="index-item"><h4>BUSAN </h4><p>ë¶€ì‚° ì¤‘êµ¬ ì¤‘ì•™ëŒ€ë¡œ 102</p></div>
        </div>
    </div>

    <script>
        const API_URL = 'https://script.google.com/macros/s/AKfycbz3_3GbX94yOQwY8poSX0iLX_71QCNPJ8NaI6mpERZiArnlmkYrpDnVsb6BDpPxIzZdTg/exec';
        let staffDB = [];

        async function init() {
            try {
                const res = await fetch(API_URL);
                staffDB = await res.json();
                renderSelectors('mgt-selectors', 'ì„œë¹„ìŠ¤ ì´ê´„', 'view-mgt');
                renderSelectors('air-selectors', 'í•­ê³µ ë‹´ë‹¹', 'view-air');
                renderSelectors('etc-selectors', 'ê¸°íƒ€(í˜¸í…”/ë¹„ì ë“±)', 'view-etc');
                syncCommon();
                document.getElementById('loading').style.display = 'none';
            } catch (e) { alert('ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨'); }
        }

        function renderSelectors(containerId, category, targetId) {
            const container = document.getElementById(containerId);
            const filtered = staffDB.filter(s => (s['ë‹´ë‹¹ êµ¬ë¶„'] || s['ë‹´ë‹¹êµ¬ë¶„']) === category);
            for (let i = 1; i <= 4; i++) {
                const div = document.createElement('div');
                div.className = 'select-box';
                div.innerHTML = `<label>${category} ${i}</label>
                    <select onchange="refreshView('${targetId}', '${containerId}')">
                        <option value="">ë‹´ë‹¹ì ì„ íƒ</option>
                        ${filtered.map(s => `<option value='${JSON.stringify(s)}'>${s['ì„±í•¨']} ${s['ì§ì±…']}</option>`).join('')}
                    </select>`;
                container.appendChild(div);
            }
        }

        function refreshView(targetId, selectorContainerId) {
            const container = document.getElementById(targetId);
            container.innerHTML = '';
            const selects = document.querySelectorAll(`#${selectorContainerId} select`);
            selects.forEach(sel => {
                if(sel.value) {
                    const s = JSON.parse(sel.value);
                    container.innerHTML += `
                        <div class="staff-card">
                            <img src="photos/${s['ì„±í•¨']}.png" onerror="this.src='https://via.placeholder.com/50?text=${s['ì„±í•¨']}'">
                            <div class="staff-info"><b>${s['ì„±í•¨']} ${s['ì§ì±…']}</b><br>${s['ì—°ë½ì²˜']}<br>${s['ì´ë©”ì¼']}</div>
                        </div>`;
                }
            });
        }

        function syncCommon() {
            const date = document.getElementById('in-date').value;
            const client = document.getElementById('in-client').value;
            document.getElementById('view-date').innerText = date;
            document.getElementById('view-client').innerText = client;
            document.querySelectorAll('.v-client-inline').forEach(el => el.innerText = client);
        }

        function loadLogo(e) {
            const out = document.getElementById('view-logo');
            if(e.target.files[0]) { out.src = URL.createObjectURL(e.target.files[0]); out.style.display = 'block'; }
        }
        window.onload = init;
    </script>
</body>
</html>
