<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì „ë‹´ ì„œë¹„ìŠ¤ ì•ˆë‚´ë¬¸ ê´€ë¦¬ ì‹œìŠ¤í…œ V1.7</title>
    <style>
        :root { --dark-blue: #1a2a4e; --point-red: #e31a1a; --beige: #bca896; --bg-gray: #f8f9fa; }
        body { font-family: 'Pretendard', sans-serif; background: #f0f2f5; margin: 0; padding: 20px; color: #333; }
        
        /* ë¡œë”© í™”ë©´ */
        #loading { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255,255,255,0.9); display: flex; justify-content: center; align-items: center; z-index: 1000; font-weight: bold; }
        
        /* ê´€ë¦¬ì íŒ¨ë„ UI (ì´ë¯¸ì§€ì˜ ì„¸ë ¨ëœ ë””ìì¸ ì ìš©) */
        .admin-panel { max-width: 1100px; margin: 0 auto 30px; background: #fff; padding: 25px; border-radius: 12px; border: 1px solid #ddd; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
        .admin-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .reg-btn { color: #4285f4; text-decoration: none; font-size: 0.9em; font-weight: bold; }
        
        .section-title { font-size: 1.1em; font-weight: bold; color: var(--point-red); margin: 30px 0 15px; display: flex; align-items: center; gap: 8px; border-left: 4px solid var(--point-red); padding-left: 10px; }
        .select-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; }
        .select-card { background: var(--bg-gray); padding: 15px; border-radius: 8px; border: 1px solid #eee; }
        .select-card label { display: block; font-size: 0.85em; font-weight: bold; margin-bottom: 8px; color: #666; }
        
        select, input[type="text"] { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; font-size: 0.9em; margin-bottom: 8px; box-sizing: border-box; }
        .info-preview { font-size: 0.75em; color: #888; background: #fff; padding: 8px; border: 1px solid #eee; min-height: 20px; border-radius: 4px; }

        /* ì¸ì‡„ìš© ì•ˆë‚´ë¬¸ ë””ìì¸ (A4) */
        .page { width: 210mm; height: 297mm; margin: 0 auto; background: white; display: flex; flex-direction: column; box-shadow: 0 0 20px rgba(0,0,0,0.1); }
        /* (ë‚˜ë¨¸ì§€ .page ê´€ë ¨ ìŠ¤íƒ€ì¼ì€ ì´ì „ê³¼ ë™ì¼í•˜ê²Œ ìœ ì§€ë©ë‹ˆë‹¤) */
        .staff-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; padding: 10px 50px; }
        .staff-card { border: 1px solid #eee; padding: 5px; border-radius: 30px 10px 10px 30px; display: flex; align-items: center; gap: 10px; height: 60px; }
        .staff-card img { width: 50px; height: 50px; border-radius: 50%; object-fit: cover; }
        .staff-info { font-size: 0.6em; line-height: 1.3; }

        @media print { .admin-panel, #loading { display: none !important; } body { padding: 0; } .page { box-shadow: none; } }
    </style>
</head>
<body>
    <div id="loading">ğŸ“¡ ì§ì› DB ì—°ë™ ì¤‘...</div>

    <div class="admin-panel">
        <div class="admin-header">
            <h2 style="margin:0;">ğŸ“‹ ì „ë‹´ ì„œë¹„ìŠ¤ ì•ˆë‚´ë¬¸ ê´€ë¦¬ (DB ì—°ë™í˜•)</h2>
            <a href="https://docs.google.com/forms/d/YOUR_FORM_ID/viewform" target="_blank" class="reg-btn">ğŸ“ ì§ì› DB ë“±ë¡/ìˆ˜ì • (Google Form)</a>
        </div>
        
        <div class="input-group" style="display:flex; gap:20px; margin-bottom:20px;">
            <div style="flex:1;"><label>ë°œì†¡ ë‚ ì§œ</label><input type="text" id="in-date" value="2026ë…„ 2ì›” 20ì¼(ê¸ˆ)" oninput="syncText()"></div>
            <div style="flex:1;"><label>ì—…ì²´ëª…</label><input type="text" id="in-client" value="LH í•œêµ­í† ì§€ì£¼íƒê³µì‚¬" oninput="syncText()"></div>
        </div>

        <div class="section-title">ğŸ‘¤ ì„œë¹„ìŠ¤ ì´ê´„ ë° ì˜ì—…ê´€ë¦¬</div>
        <div class="select-grid" id="mgt-area"></div>

        <div class="section-title">âœˆï¸ í•­ê³µ ì„œë¹„ìŠ¤íŒ€</div>
        <div class="select-grid" id="air-area"></div>

        <div class="section-title">ğŸ¨ í˜¸í…” & ğŸ›‚ ë¹„ì ì„œë¹„ìŠ¤íŒ€</div>
        <div class="select-grid" id="etc-area"></div>
        
        <button class="print-btn" onclick="window.print()" style="margin-top:30px; width:100%; padding:15px; background:var(--dark-blue); color:white; border:none; border-radius:8px; font-weight:bold; cursor:pointer;">ğŸ–¨ï¸ ì•ˆë‚´ë¬¸ ì¶œë ¥í•˜ê¸°</button>
    </div>

    <div class="page">
        <div id="print-view-content">
            <div class="staff-grid" id="view-mgt"></div>
            <div class="staff-grid" id="view-air"></div>
            <div class="staff-grid" id="view-etc"></div>
        </div>
    </div>

    <script>
        const API_URL = 'https://script.google.com/macros/s/AKfycbz3_3GbX94yOQwY8poSX0iLX_71QCNPJ8NaI6mpERZiArnlmkYrpDnVsb6BDpPxIzZdTg/exec';
        let db = [];

        async function loadDB() {
            const res = await fetch(API_URL);
            db = await res.json();
            
            renderSelectors('mgt-area', 'ì„œë¹„ìŠ¤ ì´ê´„', 'view-mgt');
            renderSelectors('air-area', 'í•­ê³µ ë‹´ë‹¹', 'view-air');
            renderSelectors('etc-area', 'ê¸°íƒ€(í˜¸í…”/ë¹„ì ë“±)', 'view-etc');
            
            document.getElementById('loading').style.display = 'none';
        }

        function renderSelectors(containerId, category, targetViewId) {
            const container = document.getElementById(containerId);
            const filtered = db.filter(s => (s['ë‹´ë‹¹ êµ¬ë¶„'] || s['ë‹´ë‹¹êµ¬ë¶„']) === category);

            for (let i = 1; i <= 3; i++) {
                const card = document.createElement('div');
                card.className = 'select-card';
                card.innerHTML = `
                    <label>${category} ${i}</label>
                    <select onchange="updateCard(this, '${targetViewId}', ${i})">
                        <option value="">ë‹´ë‹¹ì ì„ íƒ</option>
                        ${filtered.map(s => `<option value='${JSON.stringify(s)}'>${s['ì„±í•¨']} (${s['ì§ì±…']})</option>`).join('')}
                    </select>
                    <div class="info-preview" id="pre-${targetViewId}-${i}">ì§ì±…/ì„±í•¨/ì—°ë½ì²˜</div>
                `;
                container.appendChild(card);
            }
        }

        function updateCard(selectEl, viewId, index) {
            const preview = document.getElementById(`pre-${viewId}-${index}`);
            if(!selectEl.value) { preview.innerText = "ì§ì±…/ì„±í•¨/ì—°ë½ì²˜"; return; }
            
            const staff = JSON.parse(selectEl.value);
            preview.innerText = `${staff['ì§ì±…']} / ${staff['ì„±í•¨']} / ${staff['ì—°ë½ì²˜']}`;
            
            // í•˜ë‹¨ ì•ˆë‚´ë¬¸ ì¹´ë“œ ì—…ë°ì´íŠ¸ ë¡œì§
            refreshPrintView();
        }

        function refreshPrintView() {
            // ì„ íƒëœ ê°’ë“¤ì„ ëª¨ì•„ì„œ í•˜ë‹¨ ì•ˆë‚´ë¬¸ .page ë‚´ë¶€ì˜ staff-gridë¥¼ ë‹¤ì‹œ ê·¸ë¦¼
            // (ì´ ë¶€ë¶„ì— ì¹´ë“œ ìƒì„± HTML ì½”ë“œë¥¼ ë„£ìœ¼ë©´ ì‹¤ì‹œê°„ ë°˜ì˜ë©ë‹ˆë‹¤)
        }

        window.onload = loadDB;
    </script>
</body>
</html>
